\documentclass{article}
\usepackage{amsmath}
\usepackage{array}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage[ margin=1.4in ]{geometry}

\begin{document}

\begin{center}
    \textbf{\LARGE Assignment 4} \\[1ex]
    \textbf{ECE 355} \\[1ex]
    \textbf{V00984826} \\[2ex]
\end{center}

\section*{Problem 1}

Consider a \textbf{byte-addressable} computer with \textbf{4-KB main memory} and a \textbf{128-byte cache} having \textbf{eight blocks}, where each block consists of \textbf{four 32-bit words}. Assume that the CPU reads \textbf{32-bit words} from the following sequence of hexadecimal addresses:

\[ 
\texttt{03C} \quad \texttt{FF4} \quad \texttt{050} \quad \texttt{070} \quad \texttt{078} \quad \texttt{0F0} \quad \texttt{FF4} \quad \texttt{03C} \quad \texttt{070} \quad \texttt{078}
\]
Show the \textbf{cache contents} at the end of this sequence (10 addresses). Calculate the corresponding \textbf{miss rate} for the following configurations:
    \begin{enumerate}
        \item \textbf{Direct-mapped cache}
        \item \textbf{2-way set-associative cache} (2 blocks per set) with \textbf{LRU} replacement
        \item \textbf{4-way set-associative cache} (4 blocks per set) with \textbf{LRU} replacement
    \end{enumerate}

\subsection*{Solution 1A}
Direct-mapped: 4-bit Block = $A_{5-2}$, 2-bit Word = $A_{1-0}$; miss rate = 7/10.
\begin{center}
\begin{tabular}{|l|c|c|c|c|r|}
\hline
Tags & Word 3 & Word 2 & Word 1 & Word 0 & Block\\\hline
- & - & - & - & - & 0 \\\hline
- & - & - & - & - & 1 \\\hline
- & - & - & - & - & 2 \\\hline
00000 & 03C* & 038 & 034 & 030 & 3 \\\hline
- & - & - & - & - & 4 \\\hline
00000 & 0FC & 0F8 & 0F4 & 0F0* & 5 \\\hline
- & - & - & - & - & 6 \\\hline
00000 & 07C & 078 & 074 & 070* & 7 \\\hline
\end{tabular}
\end{center}

\subsection*{Solution 1B} 2-way set-associative: 2-bit Set = $A_{3-2}$, 2-bit Word = $A_{1-0}$; miss rate = 6/10.

\begin{center}
\begin{tabular}{|c|c|c|c|c|c|}
\hline
Tag & Word 3 & Word 2 & Word 1 & Word 0 & Set \\\hline
000 & 03F & 03E & 03D & 03C & Set 0 \\\hline
111 & FF7 & FF6 & FF5 & FF4 & Set 0 \\\hline
 - & - & - & - & - & Set 0 \\\hline
 - & - & - & - & - & Set 0 \\\hline
001 & 053 & 052 & 051 & 050 & Set 1 \\\hline
001 & 073 & 072 & 071 & 070 & Set 1 \\\hline
001 & 07B & 07A & 079 & 078 & Set 1 \\\hline
011 & 0F3 & 0F2 & 0F1 & 0F0 & Set 1 \\\hline
\end{tabular}
\end{center}

\subsection*{Solution 1C} 4-way set-associative: 1-bit Set = $A_2$, 2-bit Word = $A_{1-0}$; miss rate = 6/10.

\begin{center}
\begin{tabular}{|c|c|c|c|c|}\hline
Tag & Word 3 & Word 2 & Word 1 & Word 0 \\\hline
0000 & 03F & 03E & 03D & 03C \\\hline
1111 & FF7 & FF6 & FF5 & FF4 \\\hline
0001 & 053 & 052 & 051 & 050 \\\hline
0001 & 073 & 072 & 071 & 070 \\\hline
0001 & 07B & 07A & 079 & 078 \\\hline
0011 & 0F3 & 0F2 & 0F1 & 0F0 \\\hline
- & - & - & - & - \\\hline
- & - & - & - & - \\\hline
\end{tabular}
\end{center}

\section*{Problem 2}
Assume a \textbf{byte-addressable} computer has \textbf{4-KB main memory} and a \textbf{64-byte cache} with \textbf{eight blocks}, where each block contains \textbf{two 32-bit words}. While executing a program, the CPU reads \textbf{32-bit words} from the following sequence of 10 addresses (in hexadecimal format):

\[
\texttt{098} \quad \texttt{094} \quad \texttt{250} \quad \texttt{09C} \quad \texttt{254} \quad \texttt{20C} \quad \texttt{258} \quad \texttt{208} \quad \texttt{250} \quad \texttt{090}
\]
Show the \textbf{cache contents} at the end of this sequence of addresses Calculate the corresponding \textbf{miss rate} for the following cache configurations:
    \begin{enumerate}
        \item Cache is \textbf{direct-mapped}.
        \item Cache is \textbf{2-way set-associative} (2 blocks per set) with \textbf{LRU} replacement.
        \item Cache is \textbf{fully-associative} with \textbf{LRU} replacement.
    \end{enumerate}

\subsection*{Solution 2A} Direct-mapped: 3-bit Block = $A_{5-3}$, 1-bit Word = $A_2$; miss rate = 8/10.

\begin{center}
\begin{tabular}{|c|c|c|c|}
\hline
Tag & Word 1 & Word 0 & Block \\\hline
02 & 094 & 098 & Block 0 \\\hline
09 & 250 & 254 & Block 1 \\\hline
08 & 208 & 20C & Block 2 \\\hline
09 & 258 & 25C & Block 3 \\\hline
02 & 090 & 094 & Block 4 \\\hline
- & - & - & Block 5 \\\hline
- & - & - & Block 6 \\\hline
- & - & - & Block 7 \\\hline
\end{tabular}
\end{center}

\subsection*{Solution 2B} 2-way set-associative: 2-bit Set = $A_{4-3}$, 1-bit Word = $A_2$; miss rate = 7/10.

\begin{center}
\begin{tabular}{|c|c|c|c|}\hline
Tag & Word 1 & Word 0 & Set \\\hline
002 & 094 & 098 & Set 0 \\\hline
009 & 250 & 254 & Set 0 \\\hline
008 & 208 & 20C & Set 1 \\\hline
009 & 258 & 25C & Set 1 \\\hline
002 & 090 & 094 & Set 2 \\\hline
\end{tabular}
\end{center}

\subsection*{Solution 2C} Fully-associative: 1-bit Word = $A_2$; miss rate = 6/10.

\begin{center}
\begin{tabular}{|c|c|c|}
\hline
Tag & Word 1 & Word 0 \\\hline
0002 & 094 & 098 \\\hline
0009 & 250 & 254 \\\hline
0008 & 208 & 20C \\\hline
0009 & 258 & 25C \\\hline
0002 & 090 & 094 \\\hline
\end{tabular}
\end{center}
\section*{Problem 3}
Assume a computer uses the same L1 and L2 caches for both data and instructions. The L1 access time is $C_1 = 2\tau$ (L1 hit), the L2 access time is $C_2 = 8\tau$ (L1 miss, L2 hit), and the main memory access time is $M = 32\tau$ (L2 miss). Assume that for some given application the L1 hit rate is $h_1 = 90\%$ (for both instructions and data). What is the L2 hit rate $h_2$ (for both instructions and data) such that $T_{\text{ave}} = 3\tau$?

\subsection*{Solution 3} The average access time formula is:
\[T_{\text{ave}} = h_1C_1 + (1-h_1)h_2C_2 + (1-h_1)(1-h_2)M\]
We have: $C_1 = 2\tau$, $C_2 = 8\tau$, $M = 32\tau$, $h_1 = 90\% = 0.9$ and $T_{\text{ave}} = 3\tau$. Substituting values into equation and then simplifying the right side:\\
\[3\tau = 0.9(2\tau) + (1-0.9)h_2(8\tau) + (1-0.9)(1-h_2)(32\tau)\]
\[3\tau = 1.8\tau + 0.1h_2(8\tau) + 0.1(1-h_2)(32\tau)\]
\[3\tau = 1.8\tau + 0.8h_2\tau + (3.2 - 3.2h_2)\tau\]
\[3\tau = 1.8\tau + 0.8h_2\tau + 3.2\tau - 3.2h_2\tau\]
\[3\tau = (1.8 + 0.8h_2 + 3.2 - 3.2h_2)\tau\]
\[3 = 1.8 + 0.8h_2 + 3.2 - 3.2h_2\]
\[3 = 5 - 2.4h_2\]
\[2.4h_2 = 2\]
\[h_2 = \frac{2}{2.4} = \frac{5}{6} \approx 0.833\]
\\\textbf{Answer:} The L2 hit rate ($h_2$) needs to be 83.3\% to achieve an average access time of $3\tau$.

\end{document}